Set-CMAntimalwarePolicy
-----------------------




### Synopsis
Configure settings for an endpoint protection antimalware policy.



---


### Description

The Set-CMAntiMalwarePolicy cmdlet configures settings for an endpoint protection antimalware policy.



First use New-CMAntimalwarePolicy (New-CMAntimalwarePolicy.md)to create the policy object. When you create the policy, use the Policy parameter to specify which types of settings the policy includes. If you use Set-CMAntiMalwarePolicy to configure settings for policy types that weren't originally added, it adds the types when you configure the settings.



For more information, see How to create and deploy antimalware policies for Endpoint Protection in Configuration Manager (/mem/configmgr/protect/deploy-use/endpoint-antimalware-policies).



> [!NOTE] > Run Configuration Manager cmdlets from the Configuration Manager site drive, for example `PS XYZ:>`. For more information, see getting started (/powershell/sccm/overview).



---


### Related Links
* [Export-CMAntimalwarePolicy](Export-CMAntimalwarePolicy)



* [Get-CMAntiMalwarePolicy](Get-CMAntiMalwarePolicy)



* [Import-CMAntimalwarePolicy](Import-CMAntimalwarePolicy)



* [Merge-CMAntimalwarePolicy](Merge-CMAntimalwarePolicy)



* [New-CMAntimalwarePolicy](New-CMAntimalwarePolicy)



* [Remove-CMAntiMalwarePolicy](Remove-CMAntiMalwarePolicy)



* [New-CMAntimalwarePolicyDeployment](New-CMAntimalwarePolicyDeployment)





---


### Examples
#### Example 1: Create an antimalware policy and enable PUA auditing
```PowerShell
$polName = "Real-time protection policy"
$polDesc = "via Pwsh by " + $env:UserName + " at " + $(Get-Date)
New-CMAntimalwarePolicy -Name $polName -Description $polDesc -Policy RealTimeProtection

Set-CMAntimalwarePolicy -Name $polName -PuaProtection Audit
```

#### Example 2: Increase the priority of an antimalware policy
```PowerShell
Set-CMAntiMalwarePolicy -Name "ContosoPolicy" -Priority Increase
```



---


### Parameters
#### **AddDefinitionUpdateFileShare**

If you select UNC file shares as a security intelligence update source, use this parameter to add more network paths to the list.






|Type        |Required|Position|PipelineInput|Aliases                                                               |
|------------|--------|--------|-------------|----------------------------------------------------------------------|
|`[String[]]`|false   |named   |False        |AddDefinitionUpdateFileSharesSources<br/>AddDefinitionUpdateFileShares|



#### **AddExcludedFilePath**

Specify a file or folder path to exclude from antimalware scans. Exclusions can help scans complete faster or avoid conflicts with some applications. It can also increase the malware risk.


Use this parameter to add more paths to the list.


For example: `%windir%\explorer.exe`, `%windir%\system32`






|Type        |Required|Position|PipelineInput|Aliases             |
|------------|--------|--------|-------------|--------------------|
|`[String[]]`|false   |named   |False        |AddExcludedFilePaths|



#### **AddExcludedFileType**

Specify a file extension to exclude all files of this type from antimalware scans. Exclusions can help scans complete faster or avoid conflicts with some applications. It can also increase the malware risk.


Use this parameter to add more types to the list.


For example: `.jpg`, `.txt`






|Type        |Required|Position|PipelineInput|Aliases             |
|------------|--------|--------|-------------|--------------------|
|`[String[]]`|false   |named   |False        |AddExcludedFileTypes|



#### **AddExcludedProcess**

Specify the path to a process executable file to exclude it from antimalware scans. Exclusions can help scans complete faster or avoid conflicts with some applications. It can also increase the malware risk.


Use this parameter to add more processes to the list.


For example: `%windir%\system32\service.exe`






|Type        |Required|Position|PipelineInput|Aliases             |
|------------|--------|--------|-------------|--------------------|
|`[String[]]`|false   |named   |False        |AddExcludedProcesses|



#### **AddThreat**

Specify a hashtable of threat names and corresponding override action. This table defines remediation actions to take when the specified threat name is detected during a scan.


Use this parameter to add more threats to the list.






|Type         |Required|Position|PipelineInput|Aliases   |
|-------------|--------|--------|-------------|----------|
|`[Hashtable]`|false   |named   |False        |AddThreats|



#### **AllowClientUserConfigLimitCpuUsage**

Set this parameter to `$true` to allow users on client computers to configure CPU usage during scans.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **AllowClientUserConfigRealTime**

Set this parameter to `$true` to allow users on client computers to configure real-time protection settings.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **AllowClientUserConfigSampleSubmission**

Set this parameter to `$true` to allow users on client computers to modify auto sample file submission settings.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **AllowDeleteQuarantineFileDaysModification**

Set this parameter to `$true` to allow users on client computers to configure the setting for quarantined file deletion.






|Type       |Required|Position|PipelineInput|Aliases                                     |
|-----------|--------|--------|-------------|--------------------------------------------|
|`[Boolean]`|false   |named   |False        |AllowUserConfigQuarantinedFileDeletionPeriod|



#### **AllowExclusionModification**

Set this parameter to `$true` to allow users on client computers to exclude files and folders, file types, and processes from scans.






|Type       |Required|Position|PipelineInput|Aliases             |
|-----------|--------|--------|-------------|--------------------|
|`[Boolean]`|false   |named   |False        |AllowUserAddExcludes|



#### **AllowMapsModification**

Set this parameter to `$true` to allow users on client computers to modify Cloud Protection Service settings.






|Type       |Required|Position|PipelineInput|Aliases                      |
|-----------|--------|--------|-------------|-----------------------------|
|`[Boolean]`|false   |named   |False        |AllowUserChangeSpyNetSettings|



#### **AllowUserViewHistory**

Set this parameter to `$true` to allow all users on client computers to view the full history results.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **CheckLatestDefinition**

Set this parameter to `$true` to check for the latest security intelligence updates before running a scan.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **CleanDefinitionUpdateFileShare**

Add this parameter to remove the list of network file shares to use as security intelligence update sources.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **CleanExcludedFilePath**

Add this parameter to remove the list of file paths to exclude from scans.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **CleanExcludedFileType**

Add this parameter to remove the list of file extensions to exclude from scans.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **CleanExcludedProcess**

Add this parameter to remove the list of processes to exclude from scans.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **CleanThreat**

Add this parameter to remove the table of predefined remediation actions for detected threat names.






|Type      |Required|Position|PipelineInput|Aliases     |
|----------|--------|--------|-------------|------------|
|`[Switch]`|false   |named   |False        |CleanThreats|



#### **CloudBlockLevel**

For the Cloud Protection Service, specify the level of blocking suspicious files.



Valid Values:

* Normal
* High
* HighExtraProtection
* BlockUnknown






|Type                   |Required|Position|PipelineInput|
|-----------------------|--------|--------|-------------|
|`[CloudBlockLevelType]`|false   |named   |False        |



#### **CreateSystemRestorePointBeforeClean**

Set this parameter to `$true` to create a system restore point before computers are cleaned.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **DefaultActionHigh**

Specify the default action that endpoint protection takes in response to a threat it classifies at the High level.



Valid Values:

* Recommended
* Quarantine
* Remove






|Type                              |Required|Position|PipelineInput|
|----------------------------------|--------|--------|-------------|
|`[DefaultActionSevereAndHighType]`|false   |named   |False        |



#### **DefaultActionLow**

Specify the default action that endpoint protection takes in response to a threat it classifies at the Low level.



Valid Values:

* None
* Quarantine
* Remove
* Allow






|Type                             |Required|Position|PipelineInput|
|---------------------------------|--------|--------|-------------|
|`[DefaultActionMediumAndLowType]`|false   |named   |False        |



#### **DefaultActionMedium**

Specify the default action that endpoint protection takes in response to a threat it classifies at the Medium level.



Valid Values:

* None
* Quarantine
* Remove
* Allow






|Type                             |Required|Position|PipelineInput|
|---------------------------------|--------|--------|-------------|
|`[DefaultActionMediumAndLowType]`|false   |named   |False        |



#### **DefaultActionSevere**

Specify the default action that endpoint protection takes in response to a threat it classifies at the Severe level.



Valid Values:

* Recommended
* Quarantine
* Remove






|Type                              |Required|Position|PipelineInput|
|----------------------------------|--------|--------|-------------|
|`[DefaultActionSevereAndHighType]`|false   |named   |False        |



#### **DefinitionUpdateFileShare**

Specify an array of UNC file share sources used to download security intelligence updates. Sources are contacted in the order specified.


If you specify this parameter, the client contacts the provided resources for updates. Once the client successfully downloads updates from one source, it doesn't contact the remaining sources in the list. If you don't specify this parameter, the list remains empty and no sources are contacted.






|Type        |Required|Position|PipelineInput|Aliases                                                         |
|------------|--------|--------|-------------|----------------------------------------------------------------|
|`[String[]]`|false   |named   |False        |DefinitionUpdateFileSharesSources<br/>DefinitionUpdateFileShares|



#### **DeleteQuarantineFileDays**

Specify the number of days that items should be kept in the Quarantine folder before being removed.


If you specify this parameter, items are removed from the Quarantine folder after the specified number of days. If you don't specify this parameter, items are kept in the Quarantine folder for the number of days specified in the default policy, which is 30 days.






|Type     |Required|Position|PipelineInput|Aliases                     |
|---------|--------|--------|-------------|----------------------------|
|`[Int32]`|false   |named   |False        |DeleteQuarantinedFilesPeriod|



#### **Description**

Specify an optional description for the antimalware policy to help you identify it.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[String]`|false   |named   |False        |



#### **DisableClientUI**

Set this parameter to `$true` to disable the client user interface.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **DisableWildcardHandling**

This parameter treats wildcard characters as literal character values. You can't combine it with ForceWildcardHandling .






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **EnableAutoSampleSubmission**

Set this parameter to `$true` to enable auto sample file submission. This feature helps Microsoft determine whether certain detected items are malicious.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **EnableCatchupScan**

Set this parameter to `$true` to force a scan of the selected scan type if a client computer is offline during two or more scheduled scans.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **EnablePuaProtection**

In version 2103 or earlier, set this parameter to `$true` to enable detection for potentially unwanted applications (PUA).


Starting in version 2107, use the PuaProtection parameter to configure this setting.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **EnableQuickScan**

Set this parameter to `$true` to run a daily quick scan on client computers.






|Type       |Required|Position|PipelineInput|Aliases             |
|-----------|--------|--------|-------------|--------------------|
|`[Boolean]`|false   |named   |False        |EnableQuickDailyScan|



#### **EnableReparsePointScanning**

Set this parameter to `$true` to enable reparse point scanning.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **EnableScheduledScan**

Set this parameter to `$true` to configure this policy to run a scheduled scan on client computers.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **EnableScriptScanning**

Set this parameter to `$true` to enable script scanning.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **EnableSignatureUpdateCatchup**

Set this parameter to `$true` to force a security intelligence update if the client computer is offline for more than two consecutive scheduled updates.






|Type       |Required|Position|PipelineInput|Aliases                             |
|-----------|--------|--------|-------------|------------------------------------|
|`[Boolean]`|false   |named   |False        |EnableSignatureUpdateCatchupInterval|



#### **ExcludeFilePath**

Specify an array of file paths for which scheduled and real-time scanning is disabled.






|Type        |Required|Position|PipelineInput|Aliases                               |
|------------|--------|--------|-------------|--------------------------------------|
|`[String[]]`|false   |named   |False        |ExcludedFilePaths<br/>ExcludeFilePaths|



#### **ExcludeFileType**

Specify an array of file types to exclude from scheduled and real-time scanning.






|Type        |Required|Position|PipelineInput|Aliases                               |
|------------|--------|--------|-------------|--------------------------------------|
|`[String[]]`|false   |named   |False        |ExcludedFileTypes<br/>ExcludeFileTypes|



#### **ExcludeProcess**

Specify an array of processes for which any files opened by any of the processes are excluded from scheduled and real-time scanning. The process itself is not excluded.






|Type        |Required|Position|PipelineInput|Aliases                               |
|------------|--------|--------|-------------|--------------------------------------|
|`[String[]]`|false   |named   |False        |ExcludedProcesses<br/>ExcludeProcesses|



#### **ExtendedCloudCheckSec**

Specify the number of seconds to allow an extended check with the Cloud Protection Service to block and scan suspicious files.






|Type     |Required|Position|PipelineInput|
|---------|--------|--------|-------------|
|`[Int32]`|false   |named   |False        |



#### **FallbackOrder**

Define which security intelligence update sources the client uses, and the order in which it contacts them.



Valid Values:

* UpdatesDistributedFromConfigurationManager
* UpdatesFromUncFileShares
* UpdatesDistributedFromWsus
* UpdatesDistributedFromMicrosoftUpdate
* UpdatesDistributedFromMicrosoftMalwareProtectionCenter






|Type                   |Required|Position|PipelineInput|
|-----------------------|--------|--------|-------------|
|`[FallbackOrderType[]]`|false   |named   |False        |



#### **FallbackToAlternateSourceHr**

If you use Configuration Manager as a source for security intelligence updates, clients will only update from alternative sources if security intelligence is older than the number of hours that you specify with this value.






|Type     |Required|Position|PipelineInput|Aliases                                        |
|---------|--------|--------|-------------|-----------------------------------------------|
|`[Int32]`|false   |named   |False        |AuGracePeriod<br/>FallbackToAlternateSourceHour|



#### **ForceWildcardHandling**

This parameter processes wildcard characters and may lead to unexpected behavior (not recommended). You can't combine it with DisableWildcardHandling .






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **FullScanNetworkDrive**

Set this parameter to `$true` to scan mapped network drives when running a full scan.






|Type       |Required|Position|PipelineInput|Aliases              |
|-----------|--------|--------|-------------|---------------------|
|`[Boolean]`|false   |named   |False        |FullScanNetworkDrives|



#### **InputObject**

Specify an antimalware policy object to configure. To get this object, use the Get-CMAntiMalwarePolicy (Get-CMAntiMalwarePolicy.md)cmdlet.






|Type             |Required|Position|PipelineInput |Aliases          |
|-----------------|--------|--------|--------------|-----------------|
|`[IResultObject]`|true    |named   |True (ByValue)|AntiMalwarePolicy|



#### **JoinSpyNet**

Specify the Cloud Protection Service membership type.


* `DoNotJoinMaps`: No information is sent.


* `BasicMembership`: Collect and send lists of detected malware.


* `AdvancedMembership`: Basic information and more comprehensive information that could contain personal information. For example, file paths and partial memory dumps.



Valid Values:

* DoNotJoinMaps
* BasicMembership
* AdvancedMembership






|Type              |Required|Position|PipelineInput|
|------------------|--------|--------|-------------|
|`[JoinSpyNetType]`|false   |named   |False        |



#### **LimitCpuUsage**

Specify the percentage to limit CPU usage during scans.



Valid Values:

* 0
* 10
* 20
* 30
* 40
* 50
* 60
* 70
* 80
* 90






|Type     |Required|Position|PipelineInput|
|---------|--------|--------|-------------|
|`[Int32]`|false   |named   |False        |



#### **MonitorFileProgramActivity**

Set this parameter to `$true` to monitor file and program activity on the client computer.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **Name**

Specify the name of an antimalware policy to configure.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[String]`|true    |named   |False        |



#### **NetworkExploitProtection**

Set this parameter to `$true` to enable protection against network-based exploits.






|Type       |Required|Position|PipelineInput|Aliases                         |
|-----------|--------|--------|-------------|--------------------------------|
|`[Boolean]`|false   |named   |False        |NetworkProtectionAgainstExploits|



#### **NewName**

Use this parameter to rename the policy that you specify with either the Name or InputObject parameters.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[String]`|false   |named   |False        |



#### **OverrideAction**

Specify the threat override action. Use this parameter with the ThreatName parameter to configure threat override settings.



Valid Values:

* None
* Quarantine
* Remove
* Allow






|Type                               |Required|Position|PipelineInput|Aliases        |
|-----------------------------------|--------|--------|-------------|---------------|
|`[DefaultActionMediumAndLowType[]]`|false   |named   |False        |OverrideActions|



#### **PassThru**

Add this parameter to return an object that represents the item with which you're working. By default, this cmdlet may not generate any output.






|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[Switch]`|false   |named   |False        |



#### **Priority**

Use this parameter to change the priority of the antimalware policy.



Valid Values:

* Increase
* Decrease






|Type                  |Required|Position|PipelineInput|
|----------------------|--------|--------|-------------|
|`[PriorityChangeType]`|false   |named   |False        |



#### **PuaProtection**

Starting in version 2107, use this parameter to configure detection for potentially unwanted applications (PUA). Specify one of the following values: `Disable`, `Enable`, or `Audit`



Valid Values:

* Disable
* Enable
* Audit






|Type             |Required|Position|PipelineInput|
|-----------------|--------|--------|-------------|
|`[PuaProtection]`|false   |named   |False        |



#### **QuickScanTime**

Specify a datetime object for when to do a daily quick scan. To get this object, use the Get-Date (/powershell/module/microsoft.powershell.utility/get-date)built-in cmdlet.






|Type        |Required|Position|PipelineInput|Aliases               |
|------------|--------|--------|-------------|----------------------|
|`[DateTime]`|false   |named   |False        |ScheduledScanQuickTime|



#### **RandomizeScheduledScanStartTime**

Set this parameter to `$true` to randomize scheduled scan and security intelligence update start times.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **RealTimeProtectionOn**

Set this parameter to `$true` to enable real-time protection.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **RealTimeScanOption**

Specify how real-time protection scans system files. For performance reasons, you might have to change the default value if a server has high incoming or outgoing file activity.



Valid Values:

* ScanIncomingAndOutgoingFiles
* ScanIncomingFilesOnly
* ScanOutgoingFilesOnly






|Type                      |Required|Position|PipelineInput|
|--------------------------|--------|--------|-------------|
|`[RealTimeScanOptionType]`|false   |named   |False        |



#### **RemoveDefinitionUpdateFileShare**

Specify the network file share paths to remove from the list. To clear the entire list, use the CleanDefinitionUpdateFileShare parameter.






|Type        |Required|Position|PipelineInput|Aliases                                                                     |
|------------|--------|--------|-------------|----------------------------------------------------------------------------|
|`[String[]]`|false   |named   |False        |RemoveDefinitionUpdateFileSharesSources<br/>RemoveDefinitionUpdateFileShares|



#### **RemoveExcludedFilePath**

Specify the excluded file paths to remove from the list. To clear the entire list, use the CleanExcludedFilePath parameter.






|Type        |Required|Position|PipelineInput|Aliases                |
|------------|--------|--------|-------------|-----------------------|
|`[String[]]`|false   |named   |False        |RemoveExcludedFilePaths|



#### **RemoveExcludedFileType**

Specify the excluded file types to remove from the list. To clear the entire list, use the CleanExcludedFileType parameter.






|Type        |Required|Position|PipelineInput|Aliases                |
|------------|--------|--------|-------------|-----------------------|
|`[String[]]`|false   |named   |False        |RemoveExcludedFileTypes|



#### **RemoveExcludedProcess**

Specify the excluded processes to remove from the list. To clear the entire list, use the CleanExcludedProcesses parameter.






|Type        |Required|Position|PipelineInput|Aliases                |
|------------|--------|--------|-------------|-----------------------|
|`[String[]]`|false   |named   |False        |RemoveExcludedProcesses|



#### **RemoveThreat**

Specify the names of threats to remove from the threat override table.






|Type        |Required|Position|PipelineInput|Aliases                              |
|------------|--------|--------|-------------|-------------------------------------|
|`[String[]]`|false   |named   |False        |RemoveThreats<br/>RemoveThreatsByName|



#### **ScanAllDownloaded**

Set this parameter to `$true` to scan all downloaded files and enable exploit protection for the browser.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **ScanArchive**

Set this parameter to `$true` to scan archived files, for example `.zip` or `.cab` files.






|Type       |Required|Position|PipelineInput|Aliases          |
|-----------|--------|--------|-------------|-----------------|
|`[Boolean]`|false   |named   |False        |ScanArchivedFiles|



#### **ScanEmail**

Set this parameter to `$true` to scan email and email attachments.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **ScanNetworkDrive**

Set this parameter to `$true` to scan network files.






|Type       |Required|Position|PipelineInput|Aliases          |
|-----------|--------|--------|-------------|-----------------|
|`[Boolean]`|false   |named   |False        |ScanNetworkDrives|



#### **ScanRemovableStorage**

Set this parameter to `$true` to scan removable storage devices such as USB drives.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **ScanWhenClientNotInUse**

Set this parameter to `$true` to start a scheduled scan only when the computer is idle.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **ScheduledScanTime**

Specify a datetime object for when to do a scheduled scan. To get this object, use the Get-Date (/powershell/module/microsoft.powershell.utility/get-date)built-in cmdlet.






|Type        |Required|Position|PipelineInput|
|------------|--------|--------|-------------|
|`[DateTime]`|false   |named   |False        |



#### **ScheduledScanType**

Specify the type of a scheduled scan.


* `QuickScan`: This type of scan checks the in-memory processes and folders where malware is typically found. It requires fewer resources than a full scan.


* `FullScan`: This type of scan adds a full check of all local files and folders to the items scanned in the quick scan. This scan takes longer than a quick scan and uses more CPU processing and memory resources on client computers.


In most cases, use Quick scan to minimize the use of system resources on client computers. If malware removal requires a full scan, endpoint protection generates an alert that's displayed in the Configuration Manager console. The default value is Quick scan .



Valid Values:

* None
* QuickScan
* FullScan






|Type                 |Required|Position|PipelineInput|
|---------------------|--------|--------|-------------|
|`[ScheduledScanType]`|false   |named   |False        |



#### **ScheduledScanUserControl**

Specify the user control of scheduled scans.



Valid Values:

* NoControl
* ScanTimeOnly
* FullControl






|Type                            |Required|Position|PipelineInput|
|--------------------------------|--------|--------|-------------|
|`[ScheduledScanUserControlType]`|false   |named   |False        |



#### **ScheduledScanWeekday**

Specify the day of the week when a scheduled scan runs.



Valid Values:

* Daily
* Sunday
* Monday
* Tuesday
* Wednesday
* Thursday
* Friday
* Saturday






|Type                        |Required|Position|PipelineInput|
|----------------------------|--------|--------|-------------|
|`[ScheduledScanWeekdayType]`|false   |named   |False        |



#### **ShowNotification**

Set this parameter to `$true` to show notifications on the client computer when the user needs to run a full scan, update security intelligence, or run Windows Defender Offline.






|Type       |Required|Position|PipelineInput|Aliases                 |
|-----------|--------|--------|-------------|------------------------|
|`[Boolean]`|false   |named   |False        |ShowNotificationMessages|



#### **SignatureUpdateHr**

Specify the interval of hours between checks for security intelligence updates. Use an integer value up to 24, for example:


* `0`: Disable check on interval


* `1`: Check for updates every hour


* `24`: Check once per day






|Type     |Required|Position|PipelineInput|Aliases                                                |
|---------|--------|--------|-------------|-------------------------------------------------------|
|`[Int32]`|false   |named   |False        |SignatureUpdateInterval<br/>SignatureUpdateIntervalHour|



#### **SignatureUpdateTime**

Specify a datetime object for when the client checks for security intelligence updates each day. To get this object, use the Get-Date (/powershell/module/microsoft.powershell.utility/get-date)built-in cmdlet.


This setting only applies if you disable interval-based checks with `-SignatureUpdateHr 0`.






|Type        |Required|Position|PipelineInput|
|------------|--------|--------|-------------|
|`[DateTime]`|false   |named   |False        |



#### **ThreatName**

Specify the name of a threat. Use this parameter with the OverrideAction parameter to configure threat override settings.






|Type        |Required|Position|PipelineInput|Aliases    |
|------------|--------|--------|-------------|-----------|
|`[String[]]`|false   |named   |False        |ThreatNames|



#### **UseBehaviorMonitor**

Set this parameter to `$true` to enable behavior monitoring.






|Type       |Required|Position|PipelineInput|
|-----------|--------|--------|-------------|
|`[Boolean]`|false   |named   |False        |



#### **Confirm**
-Confirm is an automatic variable that is created when a command has ```[CmdletBinding(SupportsShouldProcess)]```.
-Confirm is used to -Confirm each operation.

If you pass ```-Confirm:$false``` you will not be prompted.


If the command sets a ```[ConfirmImpact("Medium")]``` which is lower than ```$confirmImpactPreference```, you will not be prompted unless -Confirm is passed.

#### **WhatIf**
-WhatIf is an automatic variable that is created when a command has ```[CmdletBinding(SupportsShouldProcess)]```.
-WhatIf is used to see what would happen, or return operations without executing them


---


### Inputs
Microsoft.ConfigurationManagement.ManagementProvider.IResultObject





---


### Outputs
* [Object](https://learn.microsoft.com/en-us/dotnet/api/System.Object)






---


### Notes




---


### Syntax
```PowerShell
Set-CMAntimalwarePolicy [-AddDefinitionUpdateFileShare <String[]>] [-CleanDefinitionUpdateFileShare] [-DefinitionUpdateFileShare <String[]>] [-DisableWildcardHandling] [-EnableSignatureUpdateCatchup <Boolean>] [-FallbackOrder {UpdatesDistributedFromConfigurationManager | UpdatesFromUncFileShares | UpdatesDistributedFromWsus | UpdatesDistributedFromMicrosoftUpdate | UpdatesDistributedFromMicrosoftMalwareProtectionCenter}] [-FallbackToAlternateSourceHr <Int32>] [-ForceWildcardHandling] -Name <String> [-PassThru] [-RemoveDefinitionUpdateFileShare <String[]>] [-SignatureUpdateHr <Int32>] [-SignatureUpdateTime <DateTime>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AddDefinitionUpdateFileShare <String[]>] [-CleanDefinitionUpdateFileShare] [-DefinitionUpdateFileShare <String[]>] [-DisableWildcardHandling] [-EnableSignatureUpdateCatchup <Boolean>] [-FallbackOrder {UpdatesDistributedFromConfigurationManager | UpdatesFromUncFileShares | UpdatesDistributedFromWsus | UpdatesDistributedFromMicrosoftUpdate | UpdatesDistributedFromMicrosoftMalwareProtectionCenter}] [-FallbackToAlternateSourceHr <Int32>] [-ForceWildcardHandling] -InputObject <IResultObject> [-PassThru] [-RemoveDefinitionUpdateFileShare <String[]>] [-SignatureUpdateHr <Int32>] [-SignatureUpdateTime <DateTime>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AddExcludedFilePath <String[]>] [-AddExcludedFileType <String[]>] [-AddExcludedProcess <String[]>] [-CleanExcludedFilePath] [-CleanExcludedFileType] [-CleanExcludedProcess] [-DisableWildcardHandling] [-ExcludeFilePath <String[]>] [-ExcludeFileType <String[]>] [-ExcludeProcess <String[]>] [-ForceWildcardHandling] -Name <String> [-PassThru] [-RemoveExcludedFilePath <String[]>] [-RemoveExcludedFileType <String[]>] [-RemoveExcludedProcess <String[]>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AddExcludedFilePath <String[]>] [-AddExcludedFileType <String[]>] [-AddExcludedProcess <String[]>] [-CleanExcludedFilePath] [-CleanExcludedFileType] [-CleanExcludedProcess] [-DisableWildcardHandling] [-ExcludeFilePath <String[]>] [-ExcludeFileType <String[]>] [-ExcludeProcess <String[]>] [-ForceWildcardHandling] -InputObject <IResultObject> [-PassThru] [-RemoveExcludedFilePath <String[]>] [-RemoveExcludedFileType <String[]>] [-RemoveExcludedProcess <String[]>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AddThreat <Hashtable>] [-CleanThreat] [-DisableWildcardHandling] [-ForceWildcardHandling] -Name <String> [-OverrideAction {None | Quarantine | Remove | Allow}] [-PassThru] [-RemoveThreat <String[]>] [-ThreatName <String[]>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AddThreat <Hashtable>] [-CleanThreat] [-DisableWildcardHandling] [-ForceWildcardHandling] -InputObject <IResultObject> [-OverrideAction {None | Quarantine | Remove | Allow}] [-PassThru] [-RemoveThreat <String[]>] [-ThreatName <String[]>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowClientUserConfigLimitCpuUsage <Boolean>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-FullScanNetworkDrive <Boolean>] -Name <String> [-PassThru] [-ScanArchive <Boolean>] [-ScanEmail <Boolean>] [-ScanNetworkDrive <Boolean>] [-ScanRemovableStorage <Boolean>] [-ScheduledScanUserControl {NoControl | ScanTimeOnly | FullControl}] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowClientUserConfigLimitCpuUsage <Boolean>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-FullScanNetworkDrive <Boolean>] -InputObject <IResultObject> [-PassThru] [-ScanArchive <Boolean>] [-ScanEmail <Boolean>] [-ScanNetworkDrive <Boolean>] [-ScanRemovableStorage <Boolean>] [-ScheduledScanUserControl {NoControl | ScanTimeOnly | FullControl}] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowClientUserConfigRealTime <Boolean>] [-DisableWildcardHandling] [-EnablePuaProtection <Boolean>] [-EnableScriptScanning <Boolean>] [-ForceWildcardHandling] [-MonitorFileProgramActivity <Boolean>] -Name <String> [-NetworkExploitProtection <Boolean>] [-PassThru] [-PuaProtection {Disable | Enable | Audit}] [-RealTimeProtectionOn <Boolean>] [-RealTimeScanOption {ScanIncomingAndOutgoingFiles | ScanIncomingFilesOnly | ScanOutgoingFilesOnly}] [-ScanAllDownloaded <Boolean>] [-UseBehaviorMonitor <Boolean>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowClientUserConfigRealTime <Boolean>] [-DisableWildcardHandling] [-EnablePuaProtection <Boolean>] [-EnableScriptScanning <Boolean>] [-ForceWildcardHandling] -InputObject <IResultObject> [-MonitorFileProgramActivity <Boolean>] [-NetworkExploitProtection <Boolean>] [-PassThru] [-PuaProtection {Disable | Enable | Audit}] [-RealTimeProtectionOn <Boolean>] [-RealTimeScanOption {ScanIncomingAndOutgoingFiles | ScanIncomingFilesOnly | ScanOutgoingFilesOnly}] [-ScanAllDownloaded <Boolean>] [-UseBehaviorMonitor <Boolean>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowClientUserConfigSampleSubmission <Boolean>] [-AllowDeleteQuarantineFileDaysModification <Boolean>] [-AllowExclusionModification <Boolean>] [-AllowUserViewHistory <Boolean>] [-CreateSystemRestorePointBeforeClean <Boolean>] [-DeleteQuarantineFileDays <Int32>] [-DisableClientUI <Boolean>] [-DisableWildcardHandling] [-EnableAutoSampleSubmission <Boolean>] [-EnableReparsePointScanning <Boolean>] [-ForceWildcardHandling] -Name <String> [-PassThru] [-RandomizeScheduledScanStartTime <Boolean>] [-ShowNotification <Boolean>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowClientUserConfigSampleSubmission <Boolean>] [-AllowDeleteQuarantineFileDaysModification <Boolean>] [-AllowExclusionModification <Boolean>] [-AllowUserViewHistory <Boolean>] [-CreateSystemRestorePointBeforeClean <Boolean>] [-DeleteQuarantineFileDays <Int32>] [-DisableClientUI <Boolean>] [-DisableWildcardHandling] [-EnableAutoSampleSubmission <Boolean>] [-EnableReparsePointScanning <Boolean>] [-ForceWildcardHandling] -InputObject <IResultObject> [-PassThru] [-RandomizeScheduledScanStartTime <Boolean>] [-ShowNotification <Boolean>] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowMapsModification <Boolean>] [-CloudBlockLevel {Normal | High | HighExtraProtection | BlockUnknown}] [-DisableWildcardHandling] [-ExtendedCloudCheckSec <Int32>] [-ForceWildcardHandling] [-JoinSpyNet {DoNotJoinMaps | BasicMembership | AdvancedMembership}] -Name <String> [-PassThru] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-AllowMapsModification <Boolean>] [-CloudBlockLevel {Normal | High | HighExtraProtection | BlockUnknown}] [-DisableWildcardHandling] [-ExtendedCloudCheckSec <Int32>] [-ForceWildcardHandling] -InputObject <IResultObject> [-JoinSpyNet {DoNotJoinMaps | BasicMembership | AdvancedMembership}] [-PassThru] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-CheckLatestDefinition <Boolean>] [-DisableWildcardHandling] [-EnableCatchupScan <Boolean>] [-EnableQuickScan <Boolean>] [-EnableScheduledScan <Boolean>] [-ForceWildcardHandling] [-LimitCpuUsage {0 | 10 | 20 | 30 | 40 | 50 | 60 | 70 | 80 | 90}] -Name <String> [-PassThru] [-QuickScanTime <DateTime>] [-ScanWhenClientNotInUse <Boolean>] [-ScheduledScanTime <DateTime>] [-ScheduledScanType {None | QuickScan | FullScan}] [-ScheduledScanWeekday {Daily | Sunday | Monday | Tuesday | Wednesday | Thursday | Friday | Saturday}] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-CheckLatestDefinition <Boolean>] [-DisableWildcardHandling] [-EnableCatchupScan <Boolean>] [-EnableQuickScan <Boolean>] [-EnableScheduledScan <Boolean>] [-ForceWildcardHandling] -InputObject <IResultObject> [-LimitCpuUsage {0 | 10 | 20 | 30 | 40 | 50 | 60 | 70 | 80 | 90}] [-PassThru] [-QuickScanTime <DateTime>] [-ScanWhenClientNotInUse <Boolean>] [-ScheduledScanTime <DateTime>] [-ScheduledScanType {None | QuickScan | FullScan}] [-ScheduledScanWeekday {Daily | Sunday | Monday | Tuesday | Wednesday | Thursday | Friday | Saturday}] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-DefaultActionHigh {Recommended | Quarantine | Remove}] [-DefaultActionLow {None | Quarantine | Remove | Allow}] [-DefaultActionMedium {None | Quarantine | Remove | Allow}] [-DefaultActionSevere {Recommended | Quarantine | Remove}] [-DisableWildcardHandling] [-ForceWildcardHandling] -Name <String> [-PassThru] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-DefaultActionHigh {Recommended | Quarantine | Remove}] [-DefaultActionLow {None | Quarantine | Remove | Allow}] [-DefaultActionMedium {None | Quarantine | Remove | Allow}] [-DefaultActionSevere {Recommended | Quarantine | Remove}] [-DisableWildcardHandling] [-ForceWildcardHandling] -InputObject <IResultObject> [-PassThru] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-Description <String>] [-DisableWildcardHandling] [-ForceWildcardHandling] -Name <String> [-NewName <String>] [-PassThru] [-Priority {Increase | Decrease}] [-Confirm] [-WhatIf] [<CommonParameters>]
```
```PowerShell
Set-CMAntimalwarePolicy [-Description <String>] [-DisableWildcardHandling] [-ForceWildcardHandling] -InputObject <IResultObject> [-NewName <String>] [-PassThru] [-Priority {Increase | Decrease}] [-Confirm] [-WhatIf] [<CommonParameters>]
```
